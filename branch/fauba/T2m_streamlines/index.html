<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Campo de temperatura a 2m y líneas de corriente &mdash; documentación de Documentación - </title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex/" />
    <link rel="search" title="Búsqueda" href="../search/" />
    <link rel="next" title="Interpolación a retícula regular" href="../Regrid/" />
    <link rel="prev" title="Campo de humedad relativa media diaria" href="../Mean_RH/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../" class="icon icon-home"> Documentación
            <img src="../_static/smn_horizontal_arg-01.jpg" class="logo" alt="Logotipo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenido:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Informacion_general/">Información general</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Estructura_de_datos/">Estructura de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Formato_de_datos/">Formato de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Acceso_a_los_datos/">Acceso a los datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Tutoriales/">Tutoriales</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Get_lat_lon_fecha/">Pronóstico para una latitud, longitud y fecha determinada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Meteogram/">Meteograma</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Mapas/">Mapas</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Mean_RH/">Campo de humedad relativa media diaria</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Campo de temperatura a 2m y líneas de corriente</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Regrid/">Interpolación a retícula regular</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ET0/">Campo diario de evapotranspiración de referencia</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Preguntas_frecuentes/">Preguntas frecuentes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Novedades/">Novedades</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contacto/">Contacto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../English_version/">English version</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Documentación</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../Tutoriales/">Tutoriales</a></li>
          <li class="breadcrumb-item"><a href="../Mapas/">Mapas</a></li>
      <li class="breadcrumb-item active">Campo de temperatura a 2m y líneas de corriente</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/T2m_streamlines.md.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="campo-de-temperatura-a-2m-y-lineas-de-corriente">
<h1>Campo de temperatura a 2m y líneas de corriente<a class="headerlink" href="#campo-de-temperatura-a-2m-y-lineas-de-corriente" title="Enlace permanente a este encabezado"></a></h1>
<p>Ejemplo para graficar un campo de temperatura a 2m y líneas de corriente. <br />
<em>Example to plot a 2-m temperatura and streamlines.</em></p>
<p>Video del tutorial: <br />
<em>Tutorial video:</em> <br />
<br />
<a class="reference external" href="https://www.youtube.com/watch?v=ad3TSJQPTww"><img alt="Video del tutorial" src="https://yt-embed.herokuapp.com/embed?v=ad3TSJQPTww" /></a></p>
<p>Tutorial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importamos las librerías necesarias  (en caso de ser necesario, instalar utilizando el comando pip install)</span>
<span class="c1"># We import the necessary libraries    (if needed, install by using the command pip install)</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">h5netcdf</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">s3fs</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>
</pre></div>
</div>
<p>Definimos la fecha y hora de inicialización del pronóstico: <br />
<em>We define the forecast initialization date:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">init_year</span> <span class="o">=</span> <span class="mi">2022</span>
<span class="n">init_month</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">init_day</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">init_hour</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">INIT_DATE</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">init_year</span><span class="p">,</span> <span class="n">init_month</span><span class="p">,</span> <span class="n">init_day</span><span class="p">,</span> <span class="n">init_hour</span><span class="p">)</span>
</pre></div>
</div>
<p>Definimos el plazo de pronóstico a graficar: <br />
<em>We define the forecast lead time to plot:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lead_time</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>
</div>
<p>Leemos el archivo: <br />
<em>We read the file:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;WRFDETAR_01H_{:%Y%m</span><span class="si">%d</span><span class="s1">_%H}_</span><span class="si">{:03d}</span><span class="s1">.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INIT_DATE</span><span class="p">,</span><span class="n">lead_time</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">decode_coords</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s1">&#39;h5netcdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculamos las componentes zonal y meridional del viento a 10m: <br />
<em>We calculate the zonal and meridional components of 10-m wind:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">wind_components</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;magViento10&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;dirViento10&#39;</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">dequantify</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">dequantify</span><span class="p">()</span>
</pre></div>
</div>
<p>Generamos la figura: <br />
<em>We generate the plot:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionamos la proyección de los datos</span>
<span class="c1"># We chose a map projection</span>

<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">CEN_LON</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">CEN_LAT</span><span class="p">,</span> <span class="n">standard_parallels</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">TRUELAT1</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">TRUELAT2</span><span class="p">),</span> <span class="n">cutoff</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">constrained_layout</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">subplot_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">projection</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extents</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="o">*</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">500</span><span class="o">*</span><span class="mi">4000</span><span class="p">,</span> <span class="o">-</span><span class="mi">600</span><span class="o">*</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">600</span><span class="o">*</span><span class="mi">4000</span><span class="p">],</span> <span class="n">crs</span> <span class="o">=</span> <span class="n">projection</span><span class="p">)</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">strm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;2-m Temperature and Streamlines&#39;</span><span class="p">)</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">x_inline</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">shrink</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;[°C]&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/cartopy/mpl/geoaxes.py:1703: UserWarning: The input coordinates to pcolormesh are interpreted as cell centers, but are not monotonically increasing or decreasing. This may lead to incorrectly calculated cell edges, in which case, please supply explicit cell edges to pcolormesh.
  shading=shading)
/usr/local/lib/python3.7/dist-packages/cartopy/crs.py:228: ShapelyDeprecationWarning: __len__ for multi-part geometries is deprecated and will be removed in Shapely 2.0. Check the length of the `geoms` property instead to get the  number of parts of a multi-part geometry.
  if len(multi_line_string) &gt; 1:
/usr/local/lib/python3.7/dist-packages/cartopy/crs.py:280: ShapelyDeprecationWarning: Iteration over multi-part geometries is deprecated and will be removed in Shapely 2.0. Use the `geoms` property to access the constituent parts of a multi-part geometry.
  for line in multi_line_string:
/usr/local/lib/python3.7/dist-packages/cartopy/crs.py:347: ShapelyDeprecationWarning: __len__ for multi-part geometries is deprecated and will be removed in Shapely 2.0. Check the length of the `geoms` property instead to get the  number of parts of a multi-part geometry.
  if len(p_mline) &gt; 0:
</pre></div>
</div>
<p><img alt="png" src="../_images/2mTemp_streamlines.png" /></p>
<p>Para descargar la notebook, acceder al siguiente <a class="reference download internal" download="" href="../_downloads/41a72af880f83098fdef9778cb39575b/T2m_streamlines.ipynb"><span class="xref download myst">link</span></a>. <br />
<em>To download the notebook, go to the following <a class="reference download internal" download="" href="../_downloads/41a72af880f83098fdef9778cb39575b/T2m_streamlines.ipynb"><span class="xref download myst">link</span></a>.</em></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="../Mean_RH/" class="btn btn-neutral float-left" title="Campo de humedad relativa media diaria" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="../Regrid/" class="btn btn-neutral float-right" title="Interpolación a retícula regular" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor Servicio Meteorológico Nacional 2022.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>